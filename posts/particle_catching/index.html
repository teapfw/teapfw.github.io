<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="light">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Particle Catching" />
<meta name="author" content="William Freidank" />
<meta property="og:locale" content="en" />
<meta name="description" content="The challenge involves tracking a target particle and planning a path which brings the player into contact with the target at a particular time." />
<meta property="og:description" content="The challenge involves tracking a target particle and planning a path which brings the player into contact with the target at a particular time." />
<link rel="canonical" href="/posts/particle_catching/" />
<meta property="og:url" content="/posts/particle_catching/" />
<meta property="og:site_name" content="William Freidank" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-10-21T00:00:00-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Particle Catching" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"William Freidank","url":"https://github.com/teapfw/"},"dateModified":"2025-01-12T21:56:30-05:00","datePublished":"2022-10-21T00:00:00-04:00","description":"The challenge involves tracking a target particle and planning a path which brings the player into contact with the target at a particular time.","headline":"Particle Catching","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/particle_catching/"},"url":"/posts/particle_catching/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Particle Catching | William Freidank
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="William Freidank">
<meta name="application-name" content="William Freidank">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script src="/assets/js/data/mathjax.js"></script>
  <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>


<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/./assets/img/favicons/web-app-manifest-512x512.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">William Freidank</a>
    <p class="site-subtitle fst-italic mb-0">A place to share my musings in engineering, research, and the various corners of life.</p>
  </header>
  <!-- .profile-wrapper -->

  

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        
        
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        
        
        <li class="nav-item">
          <a href="/reflections-posts/" class="nav-link">
            <i class="fa-fw fa-regular fa-comment"></i>
            

            <span>REFLECTIONS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        
        
        <li class="nav-item">
          <a href="/robotics-posts/" class="nav-link">
            <i class="fa-fw fa-brands fa-steam-symbol"></i>
            

            <span>ROBOTICS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        
        
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        
        
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        
        
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/teapfw"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/wfreidank/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Particle Catching</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Particle Catching</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1666324800"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Oct 21, 2022
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1736736990"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan 12, 2025
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                <a href="https://github.com/teapfw/">William Freidank</a>
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="881 words"
>
  <em>4 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Particle Catching</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Particle Catching</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <p>The challenge involves tracking a target particle and planning a path which brings the player into contact with the target at a particular time.</p>

<h1 id="investigation">Investigation</h1>

<h2 id="trivial-approach"><span class="me-2">Trivial approach</span><a href="#trivial-approach" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>The trivial solution is to simply command the particle to prosecute the target’s current position, without extrapolating its behavior into the future. We don’t consider this possibility further.</p>

<h2 id="naive-approach"><span class="me-2">Naive approach</span><a href="#naive-approach" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>The next simplest solution is to predict the target’s position at the specified impact time and plan a direct course to that location. The impact location is found by integrating the target’s acceleration and using its current position and velocity as initial conditions. The speed of the player along its trajectory is equal to the distance it will travel divided by the impact time.</p>

<h3 id="results"><span class="me-2">Results</span><a href="#results" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="/assets/img/posts/particle-catching/particlecatching_004.gif" class="popup img-link shimmer"><img src="/assets/img/posts/particle-catching/particlecatching_004.gif" alt="Player meeting target with quadratic path" title="Player meeting target with quadratic path" width="600" loading="lazy"></a>
<a href="/assets/img/posts/particle-catching/particlecatching_005.gif" class="popup img-link shimmer"><img src="/assets/img/posts/particle-catching/particlecatching_005.gif" alt="Player meeting target with sinusoidal path" title="Player meeting target with sinusoidal path" width="600" loading="lazy"></a></p>

<h2 id="matching-target-velocity"><span class="me-2">Matching target velocity</span><a href="#matching-target-velocity" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>It is desirable to meet the target not only at a given position in space but also while traveling at its same velocity. This would be a “soft” catch instead of a hard collision.</p>

<p>To achieve this, a path is generated at every instant time which smoothly joints the player’s current position with the expected target location. The path is generated as a Bezier curve with end tangents defined by the player’s current velocity and the target’s expected velocity.</p>

<p>In path coordinates, the player’s speed must be a function of time. A linear model would suffice to meet strictly the target’s position; however, it offers insufficient degrees of freedom to reach the same position at a specified speed. A quadratic speed model would work.</p>

\[\dot s(t) = a_2t^2 + a_1t + a_0\]

<p>The three boundary conditions require:</p>
<ol>
  <li>
    <p>The speed begin as equal to the player’s current speed</p>

\[\dot s(0) = v_0 = a_0\]
  </li>
  <li>
    <p>The speed end as equal to the expected target’s speed</p>

\[\dot s(t_f) = v_f = a_2t_f^2 + a_1t_f + a_0\]
  </li>
  <li>
    <p>The distance traveled by the player must be equal to the generated path’s length</p>

\[d = \int_0^{t_f} \dot s(t) dt = \frac{1}{3} a_2t_f^3 + \frac{1}{2} a_1t_f^2 + a_0t_f\]
  </li>
</ol>

<p>Solving the system of linear equations yields:</p>

\[a_2 = \frac{3(v_ft_f + v_0t_f - 2d)}{t_f^3} \\
a_1 = \frac{-2(v_ft_f + 2v_0t_f - 3d)}{t_f^2} \\
a_0 = v_0\]

<p>The player speed at the next simulated time-step is found as $\dot s(dt)$. To calculate velocity, the tangent vector to the planned path at the next timestep is also required. First, $\dot s(t)$ is integrated over the timestep to find $ds$, the distance traveled along the path. The parameter which yields this point along the Bezier curve is worked numerically and used to obtain the tangent vector at the particle’s next timestep. The commanded acceleration is finally obtained as the difference between the player’s next and current velocity.</p>

<h3 id="results-1"><span class="me-2">Results</span><a href="#results-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="/assets/img/posts/particle-catching/particlecatching_003_2.gif" class="popup img-link shimmer"><img src="/assets/img/posts/particle-catching/particlecatching_003_2.gif" alt="Player meeting target with quadratic path" title="Player meeting target with quadratic path" width="600" loading="lazy"></a>
<a href="/assets/img/posts/particle-catching/particlecatching_003.gif" class="popup img-link shimmer"><img src="/assets/img/posts/particle-catching/particlecatching_003.gif" alt="Player meeting target with sinusoidal path" title="Player meeting target with sinusoidal path" width="600" loading="lazy"></a></p>

<p>Unfortunately, it’s evident that variations in the target’s velocity cause large changes in the expected meet location, in turn producing rather wild player paths.</p>

<h2 id="applying-a-filter-to-tracked-acceleration"><span class="me-2">Applying a filter to tracked acceleration</span><a href="#applying-a-filter-to-tracked-acceleration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>When the player is further away from the target, it may make sense to filter rapid changes in the target’s behavior. Even small changes in acceleration extrapolate to large differences in the target’s future location; but if those changes are cyclic or noisy, the player ends up losing large amounts of energy by chasing a rapidly changing path.</p>

<p>To test this theory, a simple weight is applied to the target’s acceleration when predicting its location and impact time. The weight caps at 1.0 and limits to 0.0 when the player is infinitely far from the target.</p>

<h3 id="results-2"><span class="me-2">Results</span><a href="#results-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="/assets/img/posts/particle-catching/particlecatching_001.gif" class="popup img-link shimmer"><img src="/assets/img/posts/particle-catching/particlecatching_001.gif" alt="Player meeting target with quadratic path" title="Player meeting target with quadratic path" width="600" loading="lazy"></a>
<a href="/assets/img/posts/particle-catching/particlecatching_002.gif" class="popup img-link shimmer"><img src="/assets/img/posts/particle-catching/particlecatching_002.gif" alt="Player meeting target with sinusoidal path" title="Player meeting target with sinusoidal path" width="600" loading="lazy"></a></p>

<p>This is much better. The player still moves somewhat abruptly, leaving room for improvement. Use of a proper lowpass filter may introduce a “smoothing” lag and should be tried next.</p>

<h1 id="details">Details</h1>

<p>The plots are generated via a sandbox written in Julia. The main control loop is very simple:</p>

<div class="language-jl highlighter-rouge"><div class="code-header">
        <span data-label-text="Jl"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="k">for</span> <span class="n">t</span> <span class="k">in</span> <span class="n">time_range</span>
    <span class="c"># Stage the target</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Sinusoidal</span><span class="x">()</span>
    <span class="n">stage_path!</span><span class="x">(</span><span class="n">p</span><span class="x">,</span> <span class="n">target</span><span class="x">,</span> <span class="n">t</span><span class="x">)</span>

    <span class="c"># Control</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">N1</span><span class="x">()</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">controller!</span><span class="x">(</span><span class="n">c</span><span class="x">,</span> <span class="n">target</span><span class="x">,</span> <span class="n">player</span><span class="x">,</span> <span class="n">impact_time</span> <span class="o">-</span> <span class="n">t</span><span class="x">,</span> <span class="n">dt</span><span class="x">)</span>
    <span class="n">push!</span><span class="x">(</span><span class="n">planned_paths</span><span class="x">,</span> <span class="n">path</span><span class="x">)</span>

    <span class="c"># Step particles</span>
    <span class="n">move_particle!</span><span class="x">(</span><span class="n">target</span><span class="x">,</span> <span class="n">dt</span><span class="x">)</span>
    <span class="n">move_particle!</span><span class="x">(</span><span class="n">player</span><span class="x">,</span> <span class="n">dt</span><span class="x">)</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The particle types are simple objects:</p>

<div class="language-jl highlighter-rouge"><div class="code-header">
        <span data-label-text="Jl"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="k">struct</span><span class="nc"> Particle</span><span class="x">{</span><span class="n">T</span><span class="x">}</span>
    <span class="n">id</span><span class="o">::</span><span class="kt">Int64</span>
    <span class="n">pos</span><span class="o">::</span><span class="kt">Vector</span><span class="x">{</span><span class="kt">Vector</span><span class="x">{</span><span class="n">T</span><span class="x">}}</span>
    <span class="n">vel</span><span class="o">::</span><span class="kt">Vector</span><span class="x">{</span><span class="kt">Vector</span><span class="x">{</span><span class="n">T</span><span class="x">}}</span>
    <span class="n">acl</span><span class="o">::</span><span class="kt">Vector</span><span class="x">{</span><span class="kt">Vector</span><span class="x">{</span><span class="n">T</span><span class="x">}}</span>
    <span class="k">function</span><span class="nf"> Particle</span><span class="x">(</span><span class="n">id</span><span class="o">::</span><span class="kt">Int64</span><span class="x">)</span>
        <span class="n">new</span><span class="x">{</span><span class="kt">Float64</span><span class="x">}(</span><span class="n">id</span><span class="x">,</span> <span class="x">[</span><span class="n">fill</span><span class="x">(</span><span class="mf">0.0</span><span class="x">,</span> <span class="mi">3</span><span class="x">)],</span> <span class="x">[</span><span class="n">fill</span><span class="x">(</span><span class="mf">0.0</span><span class="x">,</span> <span class="mi">3</span><span class="x">)],</span> <span class="x">[</span><span class="n">fill</span><span class="x">(</span><span class="mf">0.0</span><span class="x">,</span> <span class="mi">3</span><span class="x">)])</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The target path is controlled by applying an acceleration:</p>

<div class="language-jl highlighter-rouge"><div class="code-header">
        <span data-label-text="Jl"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="k">abstract type</span><span class="nc"> Path</span> <span class="k">end</span>
<span class="k">struct</span><span class="nc"> Linear</span> <span class="o">&lt;:</span> <span class="n">Path</span> <span class="k">end</span>
<span class="k">struct</span><span class="nc"> Quadratic</span> <span class="o">&lt;:</span> <span class="n">Path</span> <span class="k">end</span>
<span class="k">struct</span><span class="nc"> Sinusoidal</span> <span class="o">&lt;:</span> <span class="n">Path</span>
    <span class="n">w</span><span class="o">::</span><span class="kt">Float64</span>
    <span class="n">m</span><span class="o">::</span><span class="kt">Float64</span>
    <span class="k">function</span><span class="nf"> Sinusoidal</span><span class="x">()</span>
        <span class="n">new</span><span class="x">(</span><span class="mf">2.</span><span class="x">,</span> <span class="mf">4.</span><span class="x">)</span>
    <span class="k">end</span>
<span class="k">end</span>

<span class="k">function</span><span class="nf"> stage_path!</span><span class="x">(</span><span class="n">path</span><span class="o">::</span><span class="n">Linear</span><span class="x">,</span> <span class="n">particle</span><span class="o">::</span><span class="n">Particle</span><span class="x">,</span> <span class="n">t</span><span class="o">::</span><span class="kt">Float64</span><span class="x">)</span>
    <span class="n">particle</span><span class="o">.</span><span class="n">acl</span><span class="x">[</span><span class="k">end</span><span class="x">]</span> <span class="o">=</span> <span class="x">[</span><span class="mf">0.0</span><span class="x">,</span> <span class="mf">0.0</span><span class="x">,</span> <span class="mf">0.0</span><span class="x">]</span>
<span class="k">end</span>

<span class="k">function</span><span class="nf"> stage_path!</span><span class="x">(</span><span class="n">path</span><span class="o">::</span><span class="n">Quadratic</span><span class="x">,</span> <span class="n">particle</span><span class="o">::</span><span class="n">Particle</span><span class="x">,</span> <span class="n">t</span><span class="o">::</span><span class="kt">Float64</span><span class="x">)</span>
    <span class="n">particle</span><span class="o">.</span><span class="n">acl</span><span class="x">[</span><span class="k">end</span><span class="x">]</span> <span class="o">=</span> <span class="x">[</span><span class="mf">0.0</span><span class="x">,</span> <span class="mf">2.0</span><span class="x">,</span> <span class="mf">0.0</span><span class="x">]</span>
<span class="k">end</span>

<span class="k">function</span><span class="nf"> stage_path!</span><span class="x">(</span><span class="n">path</span><span class="o">::</span><span class="n">Sinusoidal</span><span class="x">,</span> <span class="n">particle</span><span class="o">::</span><span class="n">Particle</span><span class="x">,</span> <span class="n">t</span><span class="o">::</span><span class="kt">Float64</span><span class="x">)</span>
    <span class="n">particle</span><span class="o">.</span><span class="n">acl</span><span class="x">[</span><span class="k">end</span><span class="x">]</span> <span class="o">=</span> <span class="x">[</span><span class="mf">0.0</span><span class="x">,</span> <span class="o">-</span><span class="n">path</span><span class="o">.</span><span class="n">m</span><span class="o">*</span><span class="n">sin</span><span class="x">(</span><span class="n">path</span><span class="o">.</span><span class="n">w</span><span class="o">*</span><span class="n">t</span><span class="x">),</span> <span class="mf">0.0</span><span class="x">]</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></div></div>

<p>While a sample controller commands player acceleration for the next timestep:</p>

<div class="language-jl highlighter-rouge"><div class="code-header">
        <span data-label-text="Jl"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre><span class="k">abstract type</span><span class="nc"> Controller</span> <span class="k">end</span>
<span class="k">struct</span><span class="nc"> N1</span> <span class="o">&lt;:</span> <span class="n">Controller</span> <span class="k">end</span>
<span class="k">struct</span><span class="nc"> N2</span> <span class="o">&lt;:</span> <span class="n">Controller</span> <span class="k">end</span>

<span class="c"># Based on standard position projection</span>
<span class="k">function</span><span class="nf"> controller!</span><span class="x">(</span><span class="n">controller</span><span class="o">::</span><span class="n">N1</span><span class="x">,</span> <span class="n">target</span><span class="o">::</span><span class="n">Particle</span><span class="x">,</span> <span class="n">player</span><span class="o">::</span><span class="n">Particle</span><span class="x">,</span> <span class="n">time2impact</span><span class="o">::</span><span class="kt">Float64</span><span class="x">,</span> <span class="n">dt</span><span class="o">::</span><span class="kt">Float64</span><span class="x">)</span>
    <span class="n">predicted_target_pos</span> <span class="o">=</span> <span class="n">project_particle_pos</span><span class="x">(</span><span class="n">target</span><span class="x">,</span> <span class="n">time2impact</span><span class="x">)</span>
    <span class="n">new_vel</span> <span class="o">=</span> <span class="x">(</span><span class="n">predicted_target_pos</span> <span class="o">-</span> <span class="n">player</span><span class="o">.</span><span class="n">pos</span><span class="x">[</span><span class="k">end</span><span class="x">])</span> <span class="o">/</span> <span class="n">time2impact</span>
    <span class="n">player</span><span class="o">.</span><span class="n">acl</span><span class="x">[</span><span class="k">end</span><span class="x">]</span> <span class="o">=</span> <span class="x">(</span><span class="n">new_vel</span> <span class="o">-</span> <span class="n">player</span><span class="o">.</span><span class="n">vel</span><span class="x">[</span><span class="k">end</span><span class="x">])</span> <span class="o">/</span> <span class="n">dt</span>

    <span class="c"># Return path points</span>
    <span class="n">points</span> <span class="o">=</span> <span class="x">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">0</span><span class="o">:</span><span class="mf">0.05</span><span class="o">:</span><span class="mi">1</span>
        <span class="n">push!</span><span class="x">(</span><span class="n">points</span><span class="x">,</span> <span class="n">player</span><span class="o">.</span><span class="n">pos</span><span class="x">[</span><span class="k">end</span><span class="x">]</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="x">(</span><span class="n">predicted_target_pos</span> <span class="o">-</span> <span class="n">player</span><span class="o">.</span><span class="n">pos</span><span class="x">[</span><span class="k">end</span><span class="x">]))</span>
    <span class="k">end</span>

    <span class="k">return</span> <span class="n">points</span>
<span class="k">end</span>
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/robotics/">Robotics</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/planning/"
            class="post-tag no-text-decoration"
          >planning</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          The author reserves all rights to this post.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Particle%20Catching%20-%20William%20Freidank&url=%2Fposts%2Fparticle_catching%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Particle%20Catching%20-%20William%20Freidank&u=%2Fposts%2Fparticle_catching%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=%2Fposts%2Fparticle_catching%2F&text=Particle%20Catching%20-%20William%20Freidank" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/mcbaby/">McBaby - Now 50% Off</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/self_love/">Self-love, Shame, and Narcissism</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/transparent_grime_removal/">Transparent Grime, Glare, & Noise Removal</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/artificial_potential_field_secant/">Artificial Potential Fields - The Secant Method</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/particle_catching/">Particle Catching</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/apf/">apf</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/computer-vision/">computer vision</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/controls/">controls</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/planning/">planning</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  
    
  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/transparent_grime_removal/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1745899200"
  data-df="ll"
  
>
  Apr 29, 2025
</time>

              <h4 class="pt-0 my-2">Transparent Grime, Glare, & Noise Removal</h4>
              <div class="text-muted">
                <p>Question: Can we develop an algorithm to separate distant visual features of interest from transparent foreground noise?  Sensors and robust signal processing form one leg of the proverbial Sense-D...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/artificial_potential_field_secant/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1675310400"
  data-df="ll"
  
>
  Feb  1, 2023
</time>

              <h4 class="pt-0 my-2">Artificial Potential Fields - The Secant Method</h4>
              <div class="text-muted">
                <p>Artificial potential fields (APFs) offer an interesting approach to path planning. The use of “fake forces” makes it intuitive to combine the effects of different elements in the planning scene. Ho...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Older">
      <p>-</p>
    </div>
  

  
    <a
      href="/posts/artificial_potential_field_secant/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Artificial Potential Fields - The Secant Method</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://github.com/teapfw">William Freidank</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title=""
      >All rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.0"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/apf/">apf</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/computer-vision/">computer vision</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/controls/">controls</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/planning/">planning</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

